DROP TABLE SHOPPINGCART;
DROP TABLE PURCHASES;
DROP TABLE PRODUCTS;
DROP TABLE CATEGORY;
DROP TABLE USERS;

CREATE TABLE USERS (
    id    SERIAL PRIMARY KEY,
    nam   TEXT NOT NULL,
    role  TEXT,
    age   INTEGER NOT NULL,
    sta   TEXT
);

CREATE TABLE CATEGORY (
    id    SERIAL PRIMARY KEY,
    nam   TEXT NOT NULL,
    description  TEXT,
    own BIGINT UNSIGNED,
    FOREIGN KEY (own) REFERENCES USERS(id)
);

CREATE TABLE PRODUCTS (
    id    SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    sku varchar(40) UNIQUE,
    cat BIGINT UNSIGNED,
    price INTEGER NOT NULL,
    FOREIGN KEY (cat) REFERENCES CATEGORY(id)
);

CREATE TABLE SHOPPINGCART (
id SERIAL PRIMARY KEY,
customer BIGINT UNSIGNED,
product BIGINT UNSIGNED,
amount INTEGER,
FOREIGN KEY (customer) REFERENCES USERS(id),
FOREIGN KEY (product) REFERENCES PRODUCTS(id)
);

CREATE TABLE PURCHASES (
id SERIAL PRIMARY KEY,
customer BIGINT UNSIGNED,
product BIGINT UNSIGNED,
season TEXT,
FOREIGN KEY (customer) REFERENCES USERS(id),
FOREIGN KEY (product) REFERENCES PRODUCTS(id),
amount INTEGER,
creditcard TEXT NOT NULL
);
